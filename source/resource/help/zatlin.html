<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="help.css">
</head>
<body>
<h1>Zatlinについて</h1>
<p>
Zatlinは、単語の綴りを自動生成するプログラムです。
生成する規則を、非常に汎用性の高い独自の言語によって記述します。
ZpDIC内の実装の他に、Javaライブラリとして分離したものが、githubの<a href="https://github.com/Ziphil/Zatlin" class="blank">リポジトリ</a>にあります。
</p>
<p>
Zatlinでは、生成規則を記述したデータを読み込み、それに基づいて単語の綴りをランダムに生成します。
</p>
<h1>生成規則データの書き方</h1>
<h2>基本</h2>
<p>
<span class="monospace">%</span>の後に<span class="monospace">|</span>で区切った文字列を記述すると、それらの文字列のうちいずれかがランダムに出力されます。
文字列は<span class="monospace">"</span>で囲みます。
また、文末には<span class="monospace">;</span>を置いてください。
以下は、「s」か「t」か「k」のいずれかを生成する規則です。
</p>
<pre>
% "s" | "t" | "d";
</pre>
<h2>変数の定義と利用</h2>
<p>
変数名の後に<span class="monospace">=</span>を書き、その後にパターンを記述すると、そのパターンを変数に格納して、以降利用することができます。
以下は、「vowel」という名前の変数を、「a」か「e」か「i」か「u」か「o」のいずれかを生成するパターンとして定義し、このvowelというパターンで文字列を生成するよう定めています。
<pre>
vowel = "a" | "e" | "i" | "o" | "u";
% vowel;
</pre>
<h2>パターンの合成</h2>
<p>
パターン中に変数や文字列リテラルを並べて置くことで、パターンを合成することができます。
例えば以下は、「vowel」という変数を定義し、vowelが生成した文字列を「s」と「t」で挟んだ文字列を生成する規則です。
したがって、これを実行すると、「sat」か「set」か「sit」か「sot」か「sut」がランダムに出力されます。
</p>
<pre>
vowel = "a" | "e" | "i" | "o" | "u";
% "s" vowel "t";
</pre>
<p>
また以下の例は、consから文字列を2回生成して、それを連結した文字列を生成する規則です。
</p>
<pre>
cons = "s" | "t" | "k" | "n" | "h";
% cons cons;
</pre>
<h2>確率の設定</h2>
<p>
<span class="monospace">|</span>で区切られたそれぞれのパターンに対し、末尾に数を置くことで、そのパターンで生成する確率の重みを変えることができます。
例えば、<span class="monospace">2</span>を指定すると、そのパターンは他のパターンと比べて 2 倍出やすくなります。
以下を何度か実行すると、「a」と「e」が「i」と比べて2倍出やすくなっています。
つまり、「a」と「e」は2/5の確率で出力され、「i」は1/5の確率で出力されます。
</p>
<pre>
% "a" 2 | "e" 2 | "i";
</pre>
<p>
パターンの重みには、整数だけでなく小数も指定できます。
ただし、0に設定することはできません。
</p>
<p>
これまでの例のようにこの重みは省略でき、その場合は<span class="monospace">1</span>の省略と見なされます。
</p>
<h2>除外条件</h2>
<p>
パターンの後に<span class="monospace">-</span>を置き、さらにその後に<span class="monospace">|</span>で区切った文字列リテラルを記述すると、生成される文字列からここで指定された文字列を含むものが除外されます。
例えば以下では、consから文字列を2回生成して連結しますが、出力結果に「tt」か「dd」が現れた場合はそれは出力せずに、もう一度生成し直します。
</p>
<pre>
cons = "s" | "z" | "t" | "d";
% cons cons - "tt" | "dd";
</pre>
<p>
除外条件の文字列の前に<span class="monospace">^</span>を置くと、その文字列から始まるものが除外されます。
また、文字列の後に<span class="monospace">^</span>を置くと、その文字列で終わるものが除外されます。
以下の例では、「s」で終わる文字列と「d」から始まる文字列と「tt」を含む文字列が除外されます。
</p>
<pre>
cons = "s" | "z" | "t" | "d";
% cons cons - "s"^ | ^"d" | "tt";
</pre>
<p>
ここで指定された文字列の除外は、除外条件を満たす文字列が出力された場合に、もう一度文字列を生成し直すという方法で実現しています。
したがって、どのように生成しても除外条件が満たされてしまう場合や、除外条件を満たさない文字列が生成される確率が著しく低い場合は、再生成が何度も行われて、出力を得るのに時間がかかる可能性があります。
これを防ぐため、100回再生成したら再生成を諦めて空文字列を返すようになっています。
この仕様は意図しない文字列を出力する可能性があるので、パターン定義の際は注意してください。
</p>
<h2>コメント</h2>
<p>
<span class="monospace">#</span>から行末まではコメントとして扱われ、変数や生成規則の定義に関与しません。
</p>
<h2>セミコロンの省略</h2>
<p>
行末のセミコロンは省略できます。
1つの行に複数の定義文を記述する場合は、中間のセミコロンは省略できません。
</p>
<h2>複雑な例</h2>
<pre>
V = "a" 3 | "e" 3 | "i" 2 | "o" 2 | "u" 2
C = "s" | "z" | "t" | "d" | "f" | "v" | "n" | "h"
# 母音と子音
yV = V | "y" V - "yi"
# 半母音のパターン
# ただし「yi」は除外
% V | C yV | yV C | C yV C - "fy" | "vy" | "h"^
# CVCまでの1音節の単語を生成
# ただし「fy」と「vy」を含んでいたり「h」で終わったりするものは生成しない
</pre>
</body>
</html>